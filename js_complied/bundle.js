var e,t;function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},l=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),l.forEach(function(t){n(e,t,i[t])})}return e}e=this,t=function(e){class t{get value(){return this._val}set value(e){for(let t of(this._val=e,this._watchers))t.fn(e),t.time--;this._watchers=this._watchers.filter(e=>e.time>0)}watch(e,t=1/0){this._watchers.push({fn:e,time:t})}watchOnce(e){this._watchers.push({fn:e,time:1})}async nextVal(){return new Promise(e=>{this.watchOnce(()=>e(this.value))})}_checkin(e){for(let t of e)if(null==t&&null==this._val||this._val===t)return!0;return!1}async unitl(...e){for(;!this._checkin(e);)await this.nextVal();return this.value}async unitlNot(...e){for(;this._checkin(e);)await this.nextVal();return this.value}constructor(e){n(this,"_val",void 0),n(this,"_watchers",[]),this._val=e}}let l={get base(){var a,o;return null!==(o=null===(a=document.getElementById("site_data_static"))||void 0===a?void 0:a.dataset.url)&&void 0!==o?o:"/"},get root(){return new URL(this.base,window.location.origin)},url_for(e){return"/"===e[0]&&(e=e.slice(1)),this.root+e}};class s{async data(){return await this.loaded.unitl(!0),this.__data}constructor(e,i=e=>e){n(this,"loaded",new t(!1)),n(this,"__data",null),("string"==typeof e?fetch(l.url_for(e)).then(e=>e.json()):e).then(e=>{this.loaded.value=!0,this.__data=i(e)})}}function r(e,t,...n){let[i,...l]=e.split(".");i||(i="div");let a=document.createElement(i);if(a.classList.add(...l),null!=t)for(let[e,n]of Object.entries(t))"class"===e&&t.class?a.classList.add(...t.class.split(" ")):e.startsWith("on")?a.addEventListener(e.slice(2),n):a.setAttribute(e,n);return n.flat().forEach(e=>{"string"==typeof e?a.innerHTML+=e:e instanceof Element&&a.appendChild(e)}),a}function c(e){return String(e).replace(/[&<>'"]/g,e=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"})[e]||e)}function d(){try{let e=({avatar:e,href:t,title:n,description:i})=>r("div",{class:"friend-link-container"},r("div",{class:"friend-link-box"},r("aside",{class:"friend-link-avatar"},r("img",{src:c(e),href:c(t)})),r("div",{class:"friend-link-meta"},r("div",{class:"friend-link-title"},r("a",{href:c(t)},c(n))),r("div",{class:"friend-link-description"},c(i)))));document.querySelectorAll(".friend-link").forEach(t=>{t.replaceWith(e(t.dataset))})}catch(e){console.error(e)}}function u(e){setTimeout(()=>{e()},10)}var h,f,m=Object.freeze({__proto__:null,copyToClipboard:async function(e){try{await window.navigator.clipboard.writeText(e)}catch(n){let t=document.createElement("textarea");t.value=e,t.style.width="0",t.style.position="fixed",t.style.left="-999px",t.style.top="10px",t.setAttribute("readonly","readonly"),document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}finally{new Promise(e=>{let t=document.getElementById("success-indicator");null==t||t.classList.add("show"),setTimeout(()=>{null==t||t.classList.add("animated","fadeOut")},500),setTimeout(()=>{null==t||t.classList.remove("show","animated","fadeOut"),e()},1e3)})}},escapeHTML:c,h:r,make_friends_list:d,nextTick:u});class w{init(){}constructor(){document.addEventListener("DOMContentLoaded",()=>{this.init()},{once:!0})}}let v=new Map,p=new s("site.json");p.data().then(e=>{var t,n;for(let i of["pages","posts","tags","categories"])for(let l of null!==(t=e[i])&&void 0!==t?t:[]){let e=(null===(n=l.path)||void 0===n?void 0:n.replaceAll("index.html",""))||"";v.set(e,l)}});let g=(h=i({},l),f=f={data:()=>p.data(),thisPageUrl(){let e=window.location.pathname;return e.startsWith("/")&&(e=e.slice(1)),"/"!==e.slice(-1)&&(e+="/"),e=decodeURI(e)},thisPage:async()=>(await g.data(),v.get(g.thisPageUrl()))},Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(f)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n.push.apply(n,i)}return n})(Object(f)).forEach(function(e){Object.defineProperty(h,e,Object.getOwnPropertyDescriptor(f,e))}),h);async function y(e){e.url&&(e.script=await fetch(e.url).then(e=>e.text())),e.script&&Function(e.script)()}class k extends Error{constructor(e){super(),n(this,"url",void 0),this.url=e}}let b=[],E=new Map,L=new t(!1),_=new t(!1);function S(e){return!!e&&((e+="/").startsWith(g.root.href)||e.startsWith(g.base))}function O(e){var t;if(null==e&&(e=window.location.hash),!e)return;let n=decodeURI(e).slice(1),i=document.getElementById(n);i&&window.scrollTo({left:0,top:i.offsetTop+((null===(t=i.offsetParent)||void 0===t?void 0:t.offsetTop)||0)-80,behavior:"smooth"})}function x(){return{url:document.location.href,body:document.getElementsByTagName("main-outlet")[0].innerHTML,title:document.title,scrollY:window.scrollY}}function T(){E.set(document.location.href,x())}async function j(e){_.value=!0,L.value=!0,setTimeout(()=>{L.value=!1},250);let t=document.querySelector(".main.animated");null==t||t.classList.add("fadeOutDown"),null==t||t.classList.remove("fadeInDown"),await e();let n=document.querySelector(".main.animated");null==n||n.classList.remove("fadeOutDown"),null==n||n.classList.add("fadeInDown"),_.value=!1}async function P(e){var t,n,i;let l=E.get(e);if(l)return l;let a=await fetch(e).then(e=>e.text());if("string"!=typeof a)throw new k(e);let o=null===(t=a.match(/<main-outlet>([\s\S]*)<\/main-outlet>/))||void 0===t?void 0:t[1];if(!o)throw new k(e);let s=null===(n=a.match(/<head>([\s\S]*)<\/head>/))||void 0===n?void 0:n[1],r=null==s?void 0:null===(i=s.match(/<title>([\s\S]*)<\/title>/))||void 0===i?void 0:i[1];return{url:e,body:o,title:null!=r?r:r=document.title}}async function q({body:e,title:t,url:n,scrollY:i},l=!0){var a;let o,s;T(),await L.unitl(!1),l&&history.pushState({time:new Date,url:n},"",n),document.querySelector("main-outlet").innerHTML=e,document.title=t,a={url:document.location.href,body:e,title:t},(o=E.get(a.url))?Object.assign(o,a):E.set(a.url,a),I(),s=document.getElementsByClassName("sidebar")[0].clientHeight-40,i?window.scrollTo({left:0,top:i}):window.innerWidth>960?window.scrollTo({left:0,top:0,behavior:"smooth"}):window.location.href===g.url_for("/")||window.location.href.slice(0,-1)===g.url_for("/")?window.scrollTo({left:0,top:0,behavior:"smooth"}):window.scrollTo({left:0,top:s})}async function D(e,t){await j(async()=>{t&&T();let n=await P(e.href);await q(n,t)}),I()}function I(){O(),function(){var e,t;for(let n of null!==(t=null===(e=document.querySelector("main-outlet"))||void 0===e?void 0:e.getElementsByTagName("script"))&&void 0!==t?t:[])y({url:n.src,script:n.textContent})}(),b.forEach(e=>{try{e()}catch(e){console.error(e)}})}async function A(e,t=!0){if(e){if(S(e)){let n=new URL(e,window.location.origin);t&&n.pathname===window.location.pathname?(history.replaceState({time:new Date},document.title,e),O(n.hash)):D(n,t).catch(e=>{if(404===e.status||e instanceof k){window.location.href=e.url;return}console.error(e),alert(e),q(x(),!1)})}else window.location.href=e}}window.history.scrollRestoration="manual",window.addEventListener("DOMContentLoaded",()=>{I()}),window.addEventListener("popstate",e=>{e.preventDefault(),A(window.location.href,!1)},!1),document.addEventListener("click",e=>{let t=e.target;for(;t;){if(t.onclick)return;S(t.href)&&(e.preventDefault(),e.stopPropagation(),A(t.href,!0)),t=t.parentNode}});let C=function(e){b.push(e)};C(d);let M=["posts","pages","tags","categories"],W=null;async function R(e=3){if(!W)return;let t=(await H.getPageTitle()).slice(0,50);if(t){var n,i,l;if((null===(n=W.valine)||void 0===n?void 0:n.enable)&&window.Valine&&new window.Valine({el:"#vcomments",notify:W.valine.notify||!1,verify:W.valine.verify||!1,app_id:W.valine.appid,app_key:W.valine.appkey,placeholder:W.valine.placeholder,path:window.location.pathname,serverURLs:W.valine.serverURLs,visitor:!0,recordIP:!0,avatar:W.valine.avatar}),(null===(i=W.gitment)||void 0===i?void 0:i.enable)&&window.Gitment){var a={id:t,owner:W.gitment.owner,repo:W.gitment.repo,oauth:{client_id:W.gitment.client_id,client_secret:W.gitment.client_secret}};""!=W.gitment.id&&(a.id=W.gitment.id),new window.Gitment(a).render("gitment_container")}(null===(l=W.gitalk)||void 0===l?void 0:l.enable)&&window.Gitalk&&new window.Gitalk({clientID:W.gitalk.client_id,clientSecret:W.gitalk.client_secret,repo:W.gitalk.repo,owner:W.gitalk.owner,admin:[W.gitalk.owner],id:t,distractionFreeMode:!1}).render("gitalk_container")}}C(()=>R().catch(()=>{}));var U=Object.freeze({__proto__:null,load:R,setConfig:function(e){W=e}});function N(){let e=localStorage.getItem("theme");e&&document.querySelector("html").setAttribute("theme",e)}async function B(){var e,t,n,i;return null!==(i=null!==(n=null===(e=await g.thisPage())||void 0===e?void 0:e.title)&&void 0!==n?n:null===(t=document.querySelector("title"))||void 0===t?void 0:t.textContent)&&void 0!==i?i:""}N();let H={comment:U,site:g,search:new class extends w{get mainEl(){return document.querySelector(".ins-search")}get inputEl(){var e;return null===(e=this.mainEl)||void 0===e?void 0:e.querySelector(".ins-search-input")}get wrapperEl(){var e;return null===(e=this.mainEl)||void 0===e?void 0:e.querySelector(".ins-section-wrapper")}get containerEl(){var e;return null===(e=this.mainEl)||void 0===e?void 0:e.querySelector(".ins-section-container")}init(){this.buildFuse(),document.body.appendChild(this.mainEl),this.inputEl.addEventListener("keydown",e=>{switch(e.code){case"ArrowDown":this.markActive(this.getSelectedIndex()+1);break;case"ArrowUp":this.markActive(this.getSelectedIndex()-1);break;case"Enter":var t;let n=null===(t=document.querySelector(".ins-selectable.active"))||void 0===t?void 0:t.dataset.url;n&&this.gotoLink(n);break;case"Escape":this.closeWindow()}}),this.inputEl.addEventListener("input",()=>{u(()=>{this.search()})}),document.addEventListener("keydown",e=>{let t=document.querySelector(":focus");(null==t?void 0:t.tagName)==="TEXTAREA"||(null==t?void 0:t.tagName)==="INPUT"||this.showing||"s"!==e.key||u(()=>this.openWindow())}),document.addEventListener("click",e=>{e.target!==this.inputEl&&this.showing&&this.closeWindow()})}getSelectedIndex(){let e=-1;return document.querySelectorAll(".ins-selectable").forEach((t,n)=>{t.classList.contains("active")&&(e=n)}),e}markActive(e){let t=document.querySelectorAll(".ins-selectable");e=(e+Number(-2==e)+t.length)%t.length,t.forEach((t,n)=>{t.classList.remove("active"),n===e&&t.classList.add("active")})}gotoLink(e){A(e),this.closeWindow()}makeSearchItem(e,t,n,i,l){return r("div",{class:"ins-selectable ins-search-item","data-url":l,onclick:()=>{this.gotoLink(l)}},r("header",null,r("i",{class:`fa fa-${e}`}),r("span",{class:"ins-title"},null!=t&&""!==t?t:this.config.translation.untitled),n&&n!==t?r("span",{class:"ins-slug"},n):null),i?r("p",{class:"ins-search-preview"},i):null)}makeSection(e,t){let n;let i=this.config.translation[e];return 0===t.length?null:(n=t.map(t=>{var n;let i={};for(let[e,n]of Object.entries(t)){if("link"===e){i[e]=n;continue}i[e]=c(n)}for(let e of null!==(n="matches"in t?t.matches:null)&&void 0!==n?n:[]){if("link"===e.key||null==e.key)continue;let[n,l]=e.indices.reduce((e,t)=>e[1]-e[0]<t[1]-t[0]?t:e,[0,-1]);i[e.key]=c(t[e.key].slice(0,n))+"<mark>"+c(t[e.key].slice(n,l+1))+"</mark>"+c(t[e.key].slice(l+1)),"text"===e.key&&(i.text=i.text.slice(Math.max(n-20,0)))}return["posts","pages"].includes(e)?this.makeSearchItem("file",i.title,null,i.text.slice(0,150),i.link):["categories","tags"].includes(e)?this.makeSearchItem("categories"===e?"folder":"tag",i.name,i.slug,null,i.link):null}),r("section",{class:"ins-section"},r("header",{class:"ins-section-header"},i),n))}async buildFuse(){let t=await this.searchData.data();e.config.ignoreLocation=!0,e.config.includeMatches=!0,this.fuses.posts=new e(t.posts,{keys:["title","text","link"]}),this.fuses.pages=new e(t.pages,{keys:["title","text","link"]}),this.fuses.tags=new e(t.tags,{keys:["name","slug","link"]}),this.fuses.categories=new e(t.categories,{keys:["name","slug","link"]}),this.fuse_ok.value=!0}async getSearchResult(e){await this.fuse_ok.unitl(!0);let t=await this.searchData.data(),n=n=>e?this.fuses[n].search(e,{limit:5}).map(e=>i({},e,e.item)):t[n].slice(0,5);return M.map(e=>[e,n(e)])}search(){let e=this.inputEl.value;this.getSearchResult(e).then(e=>{for(let[t,n]of(this.containerEl.innerHTML="",e)){let e=this.makeSection(t,n);e&&this.containerEl.appendChild(e)}})}selectItemByDiff(e){let t=this.containerEl.querySelectorAll(".ins-selectable"),n=-1;t.forEach((e,t)=>{if(e.classList.contains("active")){e.classList.remove("active"),n=t;return}});let i=(t.length+n+e)%t.length;t[i].classList.add("active")}openWindow(){this.mainEl.classList.add("animated","fadeIn","show"),this.mainEl.classList.remove("fadeOut"),this.inputEl.focus(),u(()=>{this.inputEl.setSelectionRange(0,this.inputEl.value.length),this.showing=!0}),this.search()}closeWindow(){this.showing&&(this.mainEl.classList.add("fadeOut"),this.mainEl.classList.remove("fadeIn"),this.inputEl.blur(),this.showing=!1,setTimeout(()=>{this.mainEl.classList.remove("show")},400))}constructor(){super(),n(this,"searchData",void 0),n(this,"config",{}),n(this,"showing",!1),n(this,"fuses",{}),n(this,"fuse_ok",new t(!1)),this.searchData=new s("content.json")}},getPageTitle:B,share:{native:async()=>{window.navigator.share({url:window.location.href,text:await B(),title:await B()})}},darkLightToggle:function(){var e;let t=null!==(e=document.querySelector("html").getAttribute("theme"))&&void 0!==e?e:"default";"default"===t&&(t=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"true"),"dark"===t?localStorage.setItem("theme","light"):localStorage.setItem("theme","dark"),N()}};document.addEventListener("DOMContentLoaded",()=>{document.addEventListener("click",e=>{var t,n;(function(e,t){let n=e;if(null==n)return null;for(;!0!=t(n);)if(null==(n=n.parentElement))return null;return n})(e.target,e=>null==e?void 0:e.classList.contains("btn-toggle-more"))?(e.preventDefault(),e.stopPropagation(),null===(t=document.querySelector(".nav_right_btn"))||void 0===t||t.classList.add("expanded")):null===(n=document.querySelector(".nav_right_btn"))||void 0===n||n.classList.remove("expanded")})}),window.Anatolo=H,window.Utils=m,new class extends w{init(){document.addEventListener("scroll",()=>{var e,t;window.scrollY<200?null===(e=document.querySelector("#scroll-to-top.float-button"))||void 0===e||e.classList.add("hide"):null===(t=document.querySelector("#scroll-to-top.float-button"))||void 0===t||t.classList.remove("hide")})}}},"object"==typeof exports&&"undefined"!=typeof module?t(require("fuse.js")):"function"==typeof define&&define.amd?define(["fuse.js"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).e$1);
